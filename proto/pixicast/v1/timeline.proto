syntax = "proto3";

package pixicast.v1;

option go_package = "github.com/kinchoKayaba/pixicast/backend/gen/pixicast/v1;pixicastv1";

service TimelineService {
  rpc GetTimeline (GetTimelineRequest) returns (GetTimelineResponse);
  rpc SearchYouTubeLive (SearchYouTubeLiveRequest) returns (SearchYouTubeLiveResponse);
}

// リクエストの定義
message GetTimelineRequest {
  string date = 1;
  repeated string youtube_channel_ids = 2; // YouTubeチャンネルIDのリスト
  string before_time = 3; // ページング用：この時刻より前のイベントを取得（RFC3339形式）
  int32 limit = 4; // 取得件数（デフォルト50、最大100）
}

// レスポンスの定義
message GetTimelineResponse {
  repeated Program programs = 1;
  bool has_more = 2; // 次のページがあるかどうか
  string next_cursor = 3; // 次のページ取得用のカーソル（最後のイベントの時刻）
}

// 番組データの定義
message Program {
  string id = 1;
  string title = 2;
  string start_at = 3;
  string end_at = 4;
  string platform_name = 5;
  string image_url = 6;
  string link_url = 7;
  bool is_live = 8;
  string channel_title = 9; // チャンネル名（YouTubeの場合）
  string description = 10; // 説明文（YouTubeの場合）
  string duration = 11; // 動画の長さ（例: "PT1H30M15S" または "01:30:15"）
  string published_at = 12; // 公開日時
  int64 view_count = 13; // 再生回数
  string channel_thumbnail_url = 14; // チャンネルアイコンURL
}

// YouTubeライブ配信検索リクエスト
message SearchYouTubeLiveRequest {
  string query = 1; // 検索キーワード
  int32 max_results = 2; // 最大取得件数（デフォルト10、最大50）
}

// YouTubeライブ配信検索レスポンス
message SearchYouTubeLiveResponse {
  repeated YouTubeLiveStream streams = 1;
}

// YouTubeライブ配信データ
message YouTubeLiveStream {
  string video_id = 1;
  string title = 2;
  string channel_title = 3;
  string description = 4;
  string thumbnail_url = 5;
  string published_at = 6;
}